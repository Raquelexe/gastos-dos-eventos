<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Solicitação de Interdição</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 600px;
      margin: auto;
      background: #ffffff;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    h1 {
      text-align: center;
      margin-bottom: 25px;
    }

    label {
      font-weight: bold;
      margin-top: 15px;
      display: block;
    }

    input {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 14px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
    }

    button {
      margin-top: 25px;
      width: 100%;
      padding: 14px;
      background: #1976d2;
      color: #fff;
      border: none;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background: #135ba1;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>Solicitação de Interdição</h1>

  <form id="form">

    <label>Protocolo</label>
    <input type="text" name="protocolo" required>

    <label>Evento</label>
    <input type="text" name="evento">

    <label>Local</label>
    <input type="text" name="local">

    <div class="grid">
      <div>
        <label>R-4a</label>
        <input type="number" name="r4a" value="0">
      </div>
      <div>
        <label>R-4b</label>
        <input type="number" name="r4b" value="0">
      </div>
      <div>
        <label>R-6a</label>
        <input type="number" name="r6a" value="0">
      </div>
      <div>
        <label>R-6c</label>
        <input type="number" name="r6c" value="0">
      </div>
      <div>
        <label>Cone</label>
        <input type="number" name="cone" value="0">
      </div>
      <div>
        <label>Cavalete</label>
        <input type="number" name="cavalete" value="0">
      </div>
      <div>
        <label>Fita Zebrada</label>
        <input type="number" name="fita" value="0">
      </div>
      <div>
        <label>Barreira</label>
        <input type="number" name="barreira" value="0">
      </div>
      <div>
        <label>PMV</label>
        <input type="number" name="pmv" value="0">
      </div>
      <div>
        <label>Agentes</label>
        <input type="number" name="agentes" value="0">
      </div>
      <div>
        <label>Horas de Agentes</label>
        <input type="number" name="horas_agentes" value="0">
      </div>
      <div>
        <label>Qtd. Carro</label>
        <input type="number" name="carro_qtd" value="0">
      </div>
      <div>
        <label>Horas Carro</label>
        <input type="number" name="carro_horas" value="0">
      </div>
      <div>
        <label>Qtd. Moto</label>
        <input type="number" name="moto_qtd" value="0">
      </div>
      <div>
        <label>Horas Moto</label>
        <input type="number" name="moto_horas" value="0">
      </div>
    </div>

    <button type="submit">Enviar Solicitação</button>
  </form>
</div>

<script>
  const form = document.getElementById('form');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const dados = Object.fromEntries(new FormData(form));
    dados.data_envio = new Date().toISOString();

    const resposta = await fetch("COLE_AQUI_A_URL_DO_APPS_SCRIPT", {
      method: "POST",
      body: JSON.stringify(dados),
      headers: { "Content-Type": "application/json" }
    });

    const resultado = await resposta.json();
    alert("Enviado com sucesso! Linha: " + resultado.linha);
    form.reset();
  });
</script>

</body>
</html>
